# 智能云游

## 开发前的准备

### 安装依赖
react-router-dom zustand axios 
@react-vant/icons
react-vant （第三方UI组件库） lib-flexible  适配移动端
jwt
**开发期间的依赖**
jwt  vite-plugin-mock 
postcss postcss-pxtorem  
### 配置插件
vite配置
- alias
- mock
### 移动端适配
- main.jsx: import 'lib-flexible' //适配移动端
- index.html: user-scalable=no  禁止用户缩放
- postcss.config.js

### 配置路由
配置完成
目前双布局 分为MainLayout 和 BlankLayout
目前分为五个页面

### 开发首页

# 仿 去哪儿旅行 等旅游网

### 首页 
图片 搜索栏  本地名 南昌 
### 攻略 
（瀑布流实现帖子） 关注 推荐 单页应用SPA
### AI旅行制定师 
单页 工作流 制定旅游计划  智能云游 （结合智能前端 调用工作流API  ）
### 个人主页 
订单 定制 右上角 消息 扫码   登录  发送验证码

## Todo


骨架屏待做

智能生图：
- 一段描述：给用户提示 如何描述 默认嵌入图片景象的正中央
- 两张图片

图片理解：

图像生成：写实风格






刷算法（晚 一道贪心）

- 优化客服页的封装和css 改进 
- 完成AI客服
- 对AI客服进行路由保护 对AI服务进行路由保护

AI功能开发 叫AI想
- 先开发智能客服
- 添加虚拟打卡
- 添加文案生成


骨架屏是否需要设置多个 （叫AI想）

单独写一个聊天功能

从页面开始做起 

- 缝合一下 做个智能Agent 既可以生图 又可以回答

- 对于聊天功能 系统提示词安排 智行云游 

- 指引提问 让用户学会智能生图 默认弹出 四五张图片（点击不再提示 最后做该功能 ）

查看使用指引 用户 提问 

云游功能 单独开一个页面

将照片放在美景中 生成漫画风格

mitt 的功能实现

时间多写一下首页 瀑布流的帖子的css文字大小等开发

### day1(8.1)
- 完成了项目初始化，完成了主页布局搭建，
- 技术点：
难点：zustand + 观察者模式 + axios + mock 实现瀑布流 查看效果
css： 基本都是AI写的，gird布局等挺重要的  
AI 生图  学习了阿里的图标库的用法
总结：主页还有一些细节，先不深究实现，等后面几天再搞，包括一些性能优化
先完成再完美
- day1 主页 todo ：帖子的imgCard样式 和 优化ICON的封装化 以及 一大堆的性能优化 特别难得登录

## day2(8.2)
1. 
攻略页面开发
- 瀑布流 SPA

TODO 长按帖子 提示不喜欢这篇 就去除当前的帖子

详情页 开发 点击后 跳转到 :id的页面 传参id
详情页可以根据id 获得 帖子信息 mock

瀑布流代码可以封装 
关注和推荐都可以封装（后续做）

时间多 搜索页面开发
时间多写文章

### 难点：
- 搜索组件 防抖节流 受控组件 返回给父级元素 父级元素负责在useEffect拿去数据
- 暂定 当前localStorage的历史搜索：未登录 则隐藏  用zustand封装 制定一个fetchData的方法拿历史数据
- 热门推荐 mock拿数据 同样用zustand封装

书写顺序 
- 1. 先封装子组件-searchBox 受控搜索组件
- 2. 查看子组件能不能达到防抖节流的效果向上传递
- 3. 父组件 展示搜索建议 调用mock数据查看

Todo 逐个删除历史搜索记录
Todo 加上推荐卡片 
Todo 更改样式
Todo 性能优化

## day3(8.3)
先完成登录页面 的表单 提交 使得能够成功存储登录信息

主页开发
全局状态管理，已登录or未登录
jwt实现登录
模仿喻导之前的
mock 能够使用jwt 返回jwt后的数据



### 痛苦点
登录的一些功能没搞
- 在useLogin的store中是否要加isLogin，还是说在各种各样的页面中（包括路由守卫）查看是否需要isLogin（用响应式状态） 

- 登录界面不太好看

## day 4（8.4）
实现不同页面的是否登录功能展示

一般来说前端的REACT开发中，对于后端的'api/getUser'接口拿到的已经登录的用户信息是怎么处理的，每次对于一些需要登录才能查看的页面是 怎么鉴权的，是每次在这个页面中通过zustand的方法发送一次api/getUser，还是说在登录界面调用'api/login'之后，将这些信息存在哪个地方，对于鉴权的页面 直接查看这些信息来鉴权，这样做的话会不会出现一些问题呢，比如token过期了怎么办，请你解答我此类问题

明天：

刷完算法后 
- **将捋一遍上面的思路**，实现路由守卫 关注功能
- 完成登录功能的 跳转前一页 登录Toast 
- 完成登录功能的路由守卫 后续需要路由守卫的地方 AI助手 个人主页 Toast提醒用户登录
- 优化一些细节：当用户点击搜索时 查看用户是否 登录
<!-- - 开发主页，先暂时做一个路由守卫的通用组件，用一个骨架屏先 -->
- 时间多写卡片

- 加载中 动画 
- 首页屏

理解：
所以我想做的事是：在zustand为useStore 设置一个user表示当前的用户信息，然后在设置一个checkAuth的方法：先用查看当前是否有token和用户信息，如果有token的话但是用户信息为null,那么则 发送一次getUser看当前的token是否有效，如果有的话就设置user为当前的user，如果用户信息不为null的话，那么就啥也不用干，直接设置loading为false,加载当前的页面即可。但是我认为这样子有一个bug：如果token的过期时间为3小时，用户在浏览器待的时间都有3小时以上了，比如第四个小时，由于user一直是有的，所以在checkAuth也没有通过getUser去看token是否有效，导致用户的token实际上已经过期了，但用户还能登。但是当用户此时刷新网页或者重新进浏览器时，这个问题就能得到解决，重新进浏览器时，user会初始化为null，此时checkAuth就会从调用getUser去查看token是否过期，检查到第四个小时了，已经超过了3小时，所以就能让用户重新登录。我的理解正确吗


对于搜索组件 当用户点击搜索时，检查用户是否登录



骨架屏思路

  <!-- useEffect(() => {
    const checkAuth = async () => {
      try {
        // 如果内存中没有用户信息，但有token，尝试获取用户信息
        if (!user && localStorage.getItem('token')) {
          const currentUser = await authService.getCurrentUser()
          if (currentUser) {
            setUser(currentUser, localStorage.getItem('token'))
          }
        }
      } catch (error) {
        console.error('认证检查失败:', error)
        authService.logout()
      } finally {
        setLoading(false)
      }
    }

    checkAuth()
  }, [user, setUser])

  if (loading) {
    return <div>加载中...</div>
  }

  
  if (!isAuthenticated) {
    return <Navigate to="/login" replace />
  } -->


## 全局Todo 开干！ 向全局出发 先仔细想想

阅读代码&&模块封装
- 各式各样的性能优化：memo 
- 规范化项目 先引入react原生(先引入react官方三件套) 再引入css 最后引入组件 store 静态文件（assets图片）
- 命名规范
- 小细节：改一下底部的图标
## 痛苦点，很难找到 优化点 命名规范 没有标准的话 不好想
- 改天重新审视项目的时候，总结一下难点 并且性能优化 
- 对于命名规范：看看别人的代码后再参照，现在没有统一标准
- 上面两件事情现在先不做 现在先完善下细节部分
- toast 组件封装
    - 需要自定义，UI组件库不满足需求 
    - 自定义UI props 
    - JS 显示出来 跨层级通信
        观察者
    - mitt eventBus 事件总线
    - 订阅者使用on方法 可以订阅某个事件类型
    - 发布者可以使用emit方法 发布事件 此时 订阅者就能监听到 并且执行回调函数
    - 这样子做就能实现一个全新的组件通信方式 跨层级  



- useTitle
- **加载页** 难点 算是完成了， 但是有几个小小bug：关注页check后还会使用这个加载页
- **骨架屏** 难点
- 优化关注和推荐页
- 关注和推荐页的一些bug待修复
待开发和未找到界面的自动返回 （正在为您返回（3）秒）的效果

### 痛苦点：
攻略页面的关注和推荐 路由嵌套路由 会不会影响一些东西 二级路由里面再路由
再一次瀑布流 封装 mock等
攻略的样式参考(中间可以加些广告啥的)
安排多一些亮点 瀑布流等
关注功能的 设计 关联后续可能的个人
关注功能的路由保护（设置提示组件）
下拉刷新（难 先不考虑）

## 项目亮点
